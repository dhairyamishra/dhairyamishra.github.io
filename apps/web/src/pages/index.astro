---
import Layout from '../layouts/Layout.astro';
import Navigation from '../components/Navigation.astro';
import Footer from '../components/Footer.astro';
import BrandLogo from '../components/BrandLogo.astro';
import ProjectCard from '../components/ProjectCard.astro';
import { getCollection } from 'astro:content';

const allProjects = await getCollection('projects');
const featuredProjects = allProjects
  .filter(p => p.data.featured)
  .sort((a, b) => b.data.date.localeCompare(a.data.date))
  .slice(0, 4);

const allExperience = await getCollection('experience');
const experience = allExperience.sort((a, b) => a.data.order - b.data.order);

const skills = [
  { category: 'Languages', items: ['Python', 'TypeScript', 'JavaScript', 'Java', 'C++', 'SQL', 'HTML/CSS'], color: 'rose' },
  { category: 'ML / AI', items: ['PyTorch', 'TensorFlow', 'Hugging Face', 'scikit-learn', 'OpenCV', 'RAG', 'ChromaDB', 'FAISS', 'wandb'], color: 'gold' },
  { category: 'Cloud & DevOps', items: ['EC2', 'S3', 'Lambda', 'GKE', 'Docker', 'Kubernetes', 'Terraform', 'GitHub Actions', 'Jenkins', 'ArgoCD'], color: 'violet' },
  { category: 'Frameworks', items: ['FastAPI', 'React', 'Astro', 'Vite', 'TailwindCSS', 'Streamlit', 'Zustand', 'React Flow'], color: 'rose' },
  { category: 'Data & Storage', items: ['PostgreSQL', 'MongoDB', 'MySQL', 'Pandas', 'NumPy', 'Spark', 'HDFS', 'REST APIs'], color: 'gold' },
  { category: 'Testing & Observability', items: ['OpenTelemetry', 'Grafana', 'Prometheus', 'Playwright', 'pytest', 'Pydantic'], color: 'violet' },
];

const stats = [
  { value: '4+', label: 'Years Experience' },
  { value: '8+', label: 'Projects Shipped' },
  { value: 'NYU', label: 'Courant M.S. CS' },
  { value: 'ICML', label: '2026 Submission' },
];

const affiliations = [
  { brand: 'nyu', label: 'NYU Courant' },
  { brand: 'trine', label: 'Trine University' },
  { brand: 'cvs', label: 'CVS Health' },
  { brand: 'aetna', label: 'Aetna' },
  { brand: 'evidenza', label: 'Evidenza' },
  { brand: 'acm', label: 'ACM' },
  { brand: 'icml', label: 'ICML' },
  { brand: 'arxiv', label: 'arXiv' },
];

const companyBrand: Record<string, string> = {
  'CVS Health': 'cvs',
  'Aetna Health': 'aetna',
  'Evidenza': 'evidenza',
};
---

<Layout title="Dhairya Mishra — Software Engineer & ML Researcher">
  <Navigation />
  
  <main id="main-content">
    <!-- Hero Section -->
    <section class="relative min-h-[90vh] flex items-center justify-center overflow-hidden">
      <!-- Grid background -->
      <div class="absolute inset-0 grid-bg opacity-40"></div>
      <!-- Gradient orbs -->
      <div class="absolute top-1/4 -left-32 w-96 h-96 bg-neon-rose/5 rounded-full blur-3xl"></div>
      <div class="absolute bottom-1/4 -right-32 w-96 h-96 bg-neon-gold/5 rounded-full blur-3xl"></div>

      <div class="section-container relative z-10 text-center py-20">
        <div class="flex flex-col md:flex-row md:items-center md:justify-center md:gap-10 mb-6">
          <div class="animate-fade-in md:order-2 flex-shrink-0 mb-6 md:mb-0">
            <img
              src="/profile.jpg"
              alt="Dhairya Mishra"
              class="w-36 h-36 md:w-44 md:h-44 rounded-2xl object-cover border-2 border-neon-rose/30 shadow-[0_0_20px_rgba(212,80,96,0.15)] mx-auto"
            />
          </div>
          <div class="animate-fade-in md:text-left">
            <p class="text-neon-rose font-mono text-sm tracking-widest uppercase mb-6">Software Engineer &middot; ML Researcher</p>
            <h1 class="text-5xl sm:text-6xl md:text-7xl lg:text-8xl font-heading font-bold leading-tight">
              <span class="text-gradient-neon">Dhairya</span>
              <br />
              <span class="text-text-bright">Mishra</span>
            </h1>
          </div>
        </div>
        
        <p class="text-lg md:text-xl text-muted-light max-w-2xl mx-auto mb-10 leading-relaxed">
          Building AI/ML production systems and full-stack platforms. 
          4+ years shipping computer vision, NLP, and cloud-native services at scale.
        </p>
        
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <a href="/projects" class="btn-neon-fill">
            View Projects
            <svg class="inline-block w-4 h-4 ml-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" /></svg>
          </a>
          <a href="/contact" class="btn-neon">Get in Touch</a>
        </div>
      </div>
    </section>

    <!-- Stats Bar -->
    <section class="relative py-12 border-y border-white/5">
      <div class="section-container">
        <div class="grid grid-cols-2 md:grid-cols-4 gap-8">
          {stats.map((stat, i) => (
            <div class={`reveal reveal-delay-${i + 1} text-center`}>
              <div class="text-3xl md:text-4xl font-heading font-bold text-gradient-rose mb-1">{stat.value}</div>
              <div class="text-sm text-muted">{stat.label}</div>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- Affiliations Strip -->
    <section class="py-10 border-b border-white/5">
      <div class="section-container">
        <p class="reveal text-center text-[10px] text-muted uppercase tracking-[0.2em] mb-6">Affiliated With</p>
        <div class="brand-strip">
          {affiliations.map((item, i) => (
            <div class={`brand-strip-item reveal reveal-delay-${(i % 5) + 1}`}>
              <BrandLogo brand={item.brand} size="md" />
              <span class="text-[10px] text-muted/70">{item.label}</span>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- Featured Projects -->
    <section class="py-20 md:py-28">
      <div class="section-container">
        <div class="reveal text-center mb-14">
          <h2 class="text-3xl md:text-4xl font-heading font-bold mb-4">
            Featured <span class="text-gradient-rose">Projects</span>
          </h2>
          <p class="text-muted max-w-lg mx-auto">Research and production work spanning ML, full-stack, and cloud systems.</p>
        </div>
        
        <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
          {featuredProjects.map((project, i) => (
            <ProjectCard
              project={project}
              maxTags={4}
              revealClass={`reveal reveal-delay-${i + 1}`}
            />
          ))}
        </div>

        <div class="reveal text-center mt-10">
          <a href="/projects" class="btn-neon text-sm">
            View All Projects
            <svg class="inline-block w-4 h-4 ml-1" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" /></svg>
          </a>
        </div>
      </div>
    </section>

    <div class="divider-neon-animated"></div>

    <!-- Skills Section -->
    <section class="py-20 md:py-28">
      <div class="section-container">
        <div class="reveal text-center mb-14">
          <h2 class="text-3xl md:text-4xl font-heading font-bold mb-4">
            Skills & <span class="text-gradient-rose">Technologies</span>
          </h2>
          <p class="text-muted max-w-lg mx-auto">Full-stack proficiency across ML/AI, cloud infrastructure, and modern web frameworks.</p>
        </div>
        
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
          {skills.map((group, i) => (
            <div class={`reveal reveal-delay-${(i % 5) + 1} card-neon`}>
              <h3 class={`text-sm font-heading font-semibold uppercase tracking-wider mb-3 ${
                group.color === 'rose' ? 'text-neon-rose' : group.color === 'gold' ? 'text-neon-gold' : 'text-neon-violet'
              }`}>
                {group.category}
              </h3>
              <div class="flex flex-wrap gap-2">
                {group.items.map(item => (
                  <span class={`text-xs px-2.5 py-1 rounded-full border ${
                    group.color === 'rose' ? 'bg-neon-rose/5 text-neon-rose/80 border-neon-rose/15' :
                    group.color === 'gold' ? 'bg-neon-gold/5 text-neon-gold/80 border-neon-gold/15' :
                    'bg-neon-violet/5 text-neon-violet/80 border-neon-violet/15'
                  }`}>
                    {item}
                  </span>
                ))}
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>

    <div class="divider-neon-animated"></div>

    <!-- Experience Timeline -->
    <section class="py-20 md:py-28">
      <div class="section-container">
        <div class="reveal text-center mb-14">
          <h2 class="text-3xl md:text-4xl font-heading font-bold mb-4">
            Experience <span class="text-gradient-rose">Timeline</span>
          </h2>
        </div>
        
        <div class="relative max-w-3xl mx-auto">
          <!-- Vertical thread line -->
          <div class="absolute left-4 md:left-8 top-0 bottom-0 w-px bg-gradient-to-b from-neon-rose/40 via-neon-violet/30 to-transparent"></div>
          
          {experience.map((exp, i) => (
            <div class={`reveal reveal-delay-${i + 1} relative pl-12 md:pl-20 pb-12 last:pb-0`}>
              <div class="absolute left-[11px] md:left-[27px] top-1 w-3 h-3 rounded-full bg-neon-rose shadow-neon-sm border-2 border-base"></div>
              
              <div class="card-neon group">
                <div class="flex items-start gap-3 mb-2">
                  {companyBrand[exp.data.company] && (
                    <div class="w-9 h-9 rounded-lg bg-white/5 border border-white/10 flex items-center justify-center flex-shrink-0">
                      <BrandLogo brand={companyBrand[exp.data.company]} size="sm" />
                    </div>
                  )}
                  <div class="flex-1">
                    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                      <h3 class="text-lg font-heading font-semibold text-text-bright">{exp.data.role}</h3>
                      <span class="text-xs text-muted font-mono">{exp.data.startDate} — {exp.data.endDate}</span>
                    </div>
                    <p class="text-sm text-neon-rose/70">{exp.data.company} &middot; {exp.data.location}</p>
                  </div>
                </div>
                <div class="text-sm text-muted leading-relaxed prose-sm">
                  <Fragment set:html={(await exp.render()).Content ? '' : ''} />
                </div>
                {(exp.body || '').split('\n').filter(line => line.trim().startsWith('-')).map(line => (
                  <p class="text-sm text-muted leading-relaxed mt-2 pl-3 border-l border-white/5">
                    {line.trim().slice(2)}
                  </p>
                ))}
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>

    <div class="divider-neon-animated"></div>

    <!-- Education -->
    <section class="py-20 md:py-28">
      <div class="section-container">
        <div class="reveal text-center mb-14">
          <h2 class="text-3xl md:text-4xl font-heading font-bold mb-4">
            <span class="text-gradient-rose">Education</span>
          </h2>
        </div>
        
        <div class="grid md:grid-cols-2 gap-6 max-w-3xl mx-auto">
          <div class="reveal reveal-delay-1 card-neon group">
            <div class="flex items-start gap-4">
              <div class="w-12 h-12 rounded-lg bg-neon-violet/10 border border-neon-violet/20 flex items-center justify-center flex-shrink-0">
                <BrandLogo brand="nyu" size="lg" />
              </div>
              <div>
                <h3 class="font-heading font-semibold text-text-bright">New York University</h3>
                <p class="text-sm text-neon-rose/70">Courant Institute</p>
                <p class="text-sm text-muted mt-1">M.S. Computer Science (AI)</p>
                <div class="flex items-center gap-3 mt-2 text-xs text-muted">
                  <span>May 2026</span>
                  <span class="text-neon-rose">GPA: 3.7</span>
                </div>
              </div>
            </div>
          </div>
          
          <div class="reveal reveal-delay-2 card-neon group">
            <div class="flex items-start gap-4">
              <div class="w-12 h-12 rounded-lg bg-neon-rose/10 border border-neon-rose/20 flex items-center justify-center flex-shrink-0">
                <BrandLogo brand="trine" size="lg" />
              </div>
              <div>
                <h3 class="font-heading font-semibold text-text-bright">Trine University</h3>
                <p class="text-sm text-muted mt-1">B.S. Software Engineering & Mathematics</p>
                <div class="flex items-center gap-3 mt-2 text-xs text-muted">
                  <span>Dec 2021</span>
                  <span>Angola, IN</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- CTA Section -->
    <section class="py-20 md:py-28">
      <div class="section-container text-center">
        <div class="reveal card-neon max-w-2xl mx-auto py-12 px-8">
          <h2 class="text-2xl md:text-3xl font-heading font-bold mb-4">
            Let's <span class="text-gradient-rose">Build</span> Something
          </h2>
          <p class="text-muted mb-8 max-w-md mx-auto">
            Interested in collaborating on ML research, full-stack systems, or production AI? I'd love to hear from you.
          </p>
          <div class="flex flex-col sm:flex-row gap-4 justify-center">
            <a href="/contact" class="btn-neon-fill">Get in Touch</a>
            <a href="https://github.com/dhairyamishra" target="_blank" rel="noopener noreferrer" class="btn-neon">
              <svg class="inline-block w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0C5.374 0 0 5.373 0 12c0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23A11.509 11.509 0 0 1 12 5.803c1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576C20.566 21.797 24 17.3 24 12c0-6.627-5.373-12-12-12z"/></svg>
              View GitHub
            </a>
          </div>
        </div>
      </div>
    </section>
  </main>

  <Footer />
</Layout>
